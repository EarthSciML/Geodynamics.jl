var documenterSearchIndex = {"docs":
[{"location":"api/#API","page":"API","title":"API","text":"","category":"section"},{"location":"api/#Geodynamics.McTigueModel-Tuple{}","page":"API","title":"Geodynamics.McTigueModel","text":"McTigueModel(; name) -> ModelingToolkit.System\n\n\nMcTigue (1987) finite-sphere model for volcanic surface deformation.\n\nExtends the Mogi model by incorporating higher-order correction terms that account for the finite radius of a spherical deformation source. The correction terms depend on ε = a/d and provide improved accuracy for larger ε values.\n\nThe McTigue model agrees with FE models within 5% for ε < 0.59, compared to ε < 0.37 for the Mogi model (Taylor et al., 2021).\n\nReference: McTigue, D.F., 1987. Elastic stress and deformation near a finite spherical magma body: resolution of the point source paradox. J. Geophys. Res. 92 (B12), 12931. As presented in Taylor et al. (2021), Eqs. 3–4.\n\nParameters:\n\nG: Shear modulus (Pa)\nν: Poisson's ratio (dimensionless)\nΔP: Source overpressure (Pa)\na: Source radius (m)\nd: Source depth (m)\nx: Horizontal distance from source (m)\n\n\n\n\n\n","category":"method"},{"location":"api/#Geodynamics.MogiModel-Tuple{}","page":"API","title":"Geodynamics.MogiModel","text":"MogiModel(; name) -> ModelingToolkit.System\n\n\nMogi (1958) point-source model for volcanic surface deformation.\n\nComputes horizontal-radial (Ur) and vertical (Uz) surface displacements due to a pressurized spherical cavity in an elastic half-space, using the small-sphere (point-source) approximation (ε = a/d ≪ 1).\n\nReference: Mogi, K., 1958. Relations between the eruptions of various volcanoes and the deformations of the ground surfaces around them. Bull. Earthq. Res. Inst. 36, 99–134. As presented in Taylor et al. (2021), Eqs. 1–2.\n\nParameters:\n\nG: Shear modulus (Pa)\nν: Poisson's ratio (dimensionless)\nΔP: Source overpressure (Pa)\na: Source radius (m)\nd: Source depth (m)\nx: Horizontal distance from source (m)\n\n\n\n\n\n","category":"method"},{"location":"#Geodynamics.jl","page":"Home","title":"Geodynamics.jl","text":"Models of volcanic deformation, crustal mechanics, and tectonic processes implemented in ModelingToolkit.jl.","category":"section"},{"location":"#Models","page":"Home","title":"Models","text":"Pages = [\"mogi_mctigue.md\"]","category":"section"},{"location":"mogi_mctigue/#Mogi-and-McTigue-Volcanic-Deformation-Models","page":"Mogi & McTigue Models","title":"Mogi & McTigue Volcanic Deformation Models","text":"","category":"section"},{"location":"mogi_mctigue/#Overview","page":"Mogi & McTigue Models","title":"Overview","text":"The Mogi (1958) and McTigue (1987) models are analytical solutions for computing surface displacements caused by a pressurized spherical magma chamber embedded in an elastic, homogeneous half-space with a flat free surface. These models are widely used in volcano geodesy to interpret ground deformation observations and to infer magma reservoir properties (location, size, and overpressure).\n\nThe Mogi model approximates the magma chamber as a point source (small sphere approximation, varepsilon = ad ll 1), where a is the source radius and d is the source depth. The McTigue model extends Mogi by incorporating higher-order correction terms that account for the finite dimensions of the spherical source, providing improved accuracy for larger varepsilon values.\n\nTaylor et al. (2021) demonstrated that:\n\nThe Mogi model agrees with Finite Element models within 5% when varepsilon  037\nThe McTigue model agrees within 5% when varepsilon  059\n\nReference: Taylor, N.C., Johnson, J.H., Herd, R.A. (2021). \"Making the most of the Mogi model: Size matters.\" Journal of Volcanology and Geothermal Research, 419, 107380. https://doi.org/10.1016/j.jvolgeores.2021.107380","category":"section"},{"location":"mogi_mctigue/#Implementation","page":"Mogi & McTigue Models","title":"Implementation","text":"The models compute horizontal-radial (U_r) and vertical (U_z) surface displacements as functions of horizontal distance x from the source.","category":"section"},{"location":"mogi_mctigue/#State-Variables","page":"Mogi & McTigue Models","title":"State Variables","text":"using DataFrames, ModelingToolkit, Symbolics, DynamicQuantities\nusing Geodynamics\n\nsys = MogiModel()\nvars = unknowns(sys)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(v, escape = false)) for v in vars],\n    :Units => [dimension(ModelingToolkit.get_unit(v)) for v in vars],\n    :Description => [ModelingToolkit.getdescription(v) for v in vars]\n)","category":"section"},{"location":"mogi_mctigue/#Parameters","page":"Mogi & McTigue Models","title":"Parameters","text":"params = parameters(sys)\nparam_units = String[]\nfor p in params\n    u = ModelingToolkit.get_unit(p)\n    push!(param_units, u === nothing ? \"dimensionless\" : string(dimension(u)))\nend\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(p, escape = false)) for p in params],\n    :Units => param_units,\n    :Description => [ModelingToolkit.getdescription(p) for p in params]\n)","category":"section"},{"location":"mogi_mctigue/#Equations","page":"Mogi & McTigue Models","title":"Equations","text":"Mogi Model (Equations 1-2 from Taylor et al., 2021):\n\nequations(sys)\n\nMcTigue Model (Equations 3-4 from Taylor et al., 2021):\n\nmctigue_sys = McTigueModel()\nequations(mctigue_sys)","category":"section"},{"location":"mogi_mctigue/#Reference-Parameters-(Table-1,-Taylor-et-al.,-2021)","page":"Mogi & McTigue Models","title":"Reference Parameters (Table 1, Taylor et al., 2021)","text":"The following parameters, based on Kilauea Volcano, Hawaii, are used in the analysis below:\n\nSymbol Definition Units Value\nG Shear modulus GPa 4.0\nnu Poisson's ratio – 0.25\nDelta P Overpressure MPa 2.0\na Source radius km variable\nd Source depth km variable\nvarepsilon ad – 0.05 – 0.70\nU_r Horizontal-radial displacement m result\nU_z Vertical displacement m result","category":"section"},{"location":"mogi_mctigue/#Reference-Parameters-for-Kīlauea-Events-(Table-3,-Taylor-et-al.,-2021)","page":"Mogi & McTigue Models","title":"Reference Parameters for Kīlauea Events (Table 3, Taylor et al., 2021)","text":"Model parameters for two intrusion events at Kīlauea Volcano, Hawai'i:\n\nSymbol Definition Units Value(s)\nG Shear modulus GPa 4.0\nnu Poisson's ratio – 0.25\nDelta P Overpressure MPa −3.73, −3.55\na Radius km 0.40 – 1.10\nd Depth km 1.00 – 3.00\n\nSource overpressures are inferred from tilt measurements; −3.73 and −3.55 MPa are overpressures for events in June 2007 and March 2011 respectively.","category":"section"},{"location":"mogi_mctigue/#Analysis","page":"Mogi & McTigue Models","title":"Analysis","text":"","category":"section"},{"location":"mogi_mctigue/#Displacement-Profiles-(cf.-Figure-1-geometry)","page":"Mogi & McTigue Models","title":"Displacement Profiles (cf. Figure 1 geometry)","text":"Surface displacement profiles for both models, using the reference parameters from Table 1 of Taylor et al. (2021): G = 40 GPa, nu = 025, Delta P = 20 MPa.\n\nusing CairoMakie\nusing ModelingToolkit: mtkcompile\nusing NonlinearSolve\n\n# Compile both models\nmogi_compiled = mtkcompile(MogiModel())\nmctigue_compiled = mtkcompile(McTigueModel())\n\n# Parameters from Table 1\nG_val = 4.0e9    # Pa\nν_val = 0.25\nΔP_val = 2.0e6   # Pa\nd_val = 4000.0    # m (4 km depth)\n\n# Evaluate displacement profiles for different source radii\nx_range = range(200, 25000, length = 200)\n\nfig = Figure(size = (900, 600))\nax_ur = Axis(fig[1, 1], xlabel = \"Distance x (km)\", ylabel = \"Ur (mm)\",\n    title = \"Horizontal-Radial Displacement\")\nax_uz = Axis(fig[2, 1], xlabel = \"Distance x (km)\", ylabel = \"Uz (mm)\",\n    title = \"Vertical Displacement\")\n\ncolors_mogi = [:blue, :red, :green]\ncolors_mctigue = [:cyan, :orange, :lightgreen]\nradii = [500.0, 1000.0, 2000.0]\nlabels_a = [\"a = 0.5 km\", \"a = 1.0 km\", \"a = 2.0 km\"]\n\nfor (i, a_val) in enumerate(radii)\n    Ur_mogi = Float64[]\n    Uz_mogi = Float64[]\n    Ur_mctigue = Float64[]\n    Uz_mctigue = Float64[]\n\n    for x_val in x_range\n        # Mogi\n        prob_m = NonlinearProblem(mogi_compiled,\n            Dict([\n                mogi_compiled.G => G_val, mogi_compiled.ν => ν_val,\n                mogi_compiled.ΔP => ΔP_val, mogi_compiled.a => a_val,\n                mogi_compiled.d => d_val, mogi_compiled.x => x_val]))\n        sol_m = solve(prob_m)\n        push!(Ur_mogi, sol_m[mogi_compiled.Ur] * 1000)  # convert to mm\n        push!(Uz_mogi, sol_m[mogi_compiled.Uz] * 1000)\n\n        # McTigue\n        prob_mc = NonlinearProblem(mctigue_compiled,\n            Dict([\n                mctigue_compiled.G => G_val, mctigue_compiled.ν => ν_val,\n                mctigue_compiled.ΔP => ΔP_val, mctigue_compiled.a => a_val,\n                mctigue_compiled.d => d_val, mctigue_compiled.x => x_val]))\n        sol_mc = solve(prob_mc)\n        push!(Ur_mctigue, sol_mc[mctigue_compiled.Ur] * 1000)\n        push!(Uz_mctigue, sol_mc[mctigue_compiled.Uz] * 1000)\n    end\n\n    x_km = collect(x_range) ./ 1000\n    lines!(ax_ur, x_km, Ur_mogi, color = colors_mogi[i], label = \"Mogi \" * labels_a[i])\n    lines!(ax_ur, x_km, Ur_mctigue, color = colors_mctigue[i], linestyle = :dash,\n        label = \"McTigue \" * labels_a[i])\n    lines!(ax_uz, x_km, Uz_mogi, color = colors_mogi[i], label = \"Mogi \" * labels_a[i])\n    lines!(ax_uz, x_km, Uz_mctigue, color = colors_mctigue[i], linestyle = :dash,\n        label = \"McTigue \" * labels_a[i])\nend\n\naxislegend(ax_ur, position = :rt)\naxislegend(ax_uz, position = :rt)\nfig","category":"section"},{"location":"mogi_mctigue/#McTigue-Correction-Magnitude-vs.-epsilon-(cf.-Figure-2)","page":"Mogi & McTigue Models","title":"McTigue Correction Magnitude vs. epsilon (cf. Figure 2)","text":"The percentage difference between Mogi and McTigue predictions increases with varepsilon = ad, illustrating the growing importance of finite-body corrections.\n\nfig2 = Figure(size = (700, 500))\nax = Axis(fig2[1, 1],\n    xlabel = \"epsilon = a/d\",\n    ylabel = \"(McTigue - Mogi) / Mogi x 100 (%)\",\n    title = \"McTigue vs Mogi: Relative Difference at Ur_max and Uz_max\")\n\ndepths = [1000.0, 4000.0, 7000.0, 10000.0, 13000.0]\ndepth_colors = [:purple, :blue, :green, :orange, :gold]\ndepth_labels = [\"d = 1 km\", \"d = 4 km\", \"d = 7 km\", \"d = 10 km\", \"d = 13 km\"]\n\neps_range = range(0.05, 0.70, length = 50)\n\nfor (j, d_val) in enumerate(depths)\n    pct_diff_ur = Float64[]\n    pct_diff_uz = Float64[]\n\n    for eps_val in eps_range\n        a_val = eps_val * d_val\n\n        # Evaluate at x = x_crit for Mogi (where Ur is maximum): x_crit = d/sqrt(2)\n        x_crit = d_val / sqrt(2)\n\n        # Mogi at x_crit\n        prob_m = NonlinearProblem(mogi_compiled,\n            Dict([\n                mogi_compiled.G => G_val, mogi_compiled.ν => ν_val,\n                mogi_compiled.ΔP => ΔP_val, mogi_compiled.a => a_val,\n                mogi_compiled.d => d_val, mogi_compiled.x => x_crit]))\n        sol_m = solve(prob_m)\n\n        # McTigue at x_crit\n        prob_mc = NonlinearProblem(mctigue_compiled,\n            Dict([\n                mctigue_compiled.G => G_val, mctigue_compiled.ν => ν_val,\n                mctigue_compiled.ΔP => ΔP_val, mctigue_compiled.a => a_val,\n                mctigue_compiled.d => d_val, mctigue_compiled.x => x_crit]))\n        sol_mc = solve(prob_mc)\n\n        push!(pct_diff_ur,\n            (sol_mc[mctigue_compiled.Ur] - sol_m[mogi_compiled.Ur]) /\n            sol_m[mogi_compiled.Ur] * 100)\n        push!(pct_diff_uz,\n            (sol_mc[mctigue_compiled.Uz] - sol_m[mogi_compiled.Uz]) /\n            sol_m[mogi_compiled.Uz] * 100)\n    end\n\n    lines!(ax, collect(eps_range), pct_diff_ur, color = depth_colors[j],\n        label = depth_labels[j] * \" (Ur)\")\n    lines!(ax, collect(eps_range), pct_diff_uz, color = depth_colors[j],\n        linestyle = :dash, label = depth_labels[j] * \" (Uz)\")\nend\n\naxislegend(ax, position = :lt)\nfig2","category":"section"},{"location":"mogi_mctigue/#Kīlauea-Deflation-Event-(cf.-Table-3-and-Section-4.5)","page":"Mogi & McTigue Models","title":"Kīlauea Deflation Event (cf. Table 3 and Section 4.5)","text":"Surface displacement profiles predicted by the Mogi and McTigue models for the June 2007 Kīlauea deflation event (Delta P = -373 MPa), using the best-fitting source parameters from Taylor et al. (2021). The negative overpressure corresponds to deflation (subsidence and inward radial displacement).\n\nfig_kil = Figure(size = (900, 600))\nax_ur_kil = Axis(fig_kil[1, 1], xlabel = \"Distance x (km)\", ylabel = \"Ur (mm)\",\n    title = \"Kīlauea June 2007: Horizontal-Radial Displacement\")\nax_uz_kil = Axis(fig_kil[2, 1], xlabel = \"Distance x (km)\", ylabel = \"Uz (mm)\",\n    title = \"Kīlauea June 2007: Vertical Displacement\")\n\n# Table 3 parameters for June 2007 event\nG_kil = 4.0e9       # Pa\nν_kil = 0.25\nΔP_kil = -3.73e6    # Pa (deflation)\n\n# Representative source geometries within the Table 3 range\ncases = [\n    (a = 500.0, d = 2000.0, label = \"a=0.5km, d=2km (ε=0.25)\"),\n    (a = 800.0, d = 2000.0, label = \"a=0.8km, d=2km (ε=0.40)\"),\n    (a = 800.0, d = 3000.0, label = \"a=0.8km, d=3km (ε=0.27)\")\n]\ncase_colors_m = [:blue, :red, :green]\ncase_colors_mc = [:cyan, :orange, :lightgreen]\n\nx_range_kil = range(100, 15000, length = 150)\n\nfor (i, c) in enumerate(cases)\n    Ur_m = Float64[]\n    Uz_m = Float64[]\n    Ur_mc = Float64[]\n    Uz_mc = Float64[]\n\n    for x_val in x_range_kil\n        prob_m = NonlinearProblem(mogi_compiled,\n            Dict([mogi_compiled.G => G_kil, mogi_compiled.ν => ν_kil,\n                mogi_compiled.ΔP => ΔP_kil, mogi_compiled.a => c.a,\n                mogi_compiled.d => c.d, mogi_compiled.x => x_val]))\n        sol_m = solve(prob_m)\n        push!(Ur_m, sol_m[mogi_compiled.Ur] * 1000)\n        push!(Uz_m, sol_m[mogi_compiled.Uz] * 1000)\n\n        prob_mc = NonlinearProblem(mctigue_compiled,\n            Dict([mctigue_compiled.G => G_kil, mctigue_compiled.ν => ν_kil,\n                mctigue_compiled.ΔP => ΔP_kil, mctigue_compiled.a => c.a,\n                mctigue_compiled.d => c.d, mctigue_compiled.x => x_val]))\n        sol_mc = solve(prob_mc)\n        push!(Ur_mc, sol_mc[mctigue_compiled.Ur] * 1000)\n        push!(Uz_mc, sol_mc[mctigue_compiled.Uz] * 1000)\n    end\n\n    x_km = collect(x_range_kil) ./ 1000\n    lines!(ax_ur_kil, x_km, Ur_m, color = case_colors_m[i], label = \"Mogi \" * c.label)\n    lines!(ax_ur_kil, x_km, Ur_mc, color = case_colors_mc[i], linestyle = :dash,\n        label = \"McTigue \" * c.label)\n    lines!(ax_uz_kil, x_km, Uz_m, color = case_colors_m[i], label = \"Mogi \" * c.label)\n    lines!(ax_uz_kil, x_km, Uz_mc, color = case_colors_mc[i], linestyle = :dash,\n        label = \"McTigue \" * c.label)\nend\n\naxislegend(ax_ur_kil, position = :rb)\naxislegend(ax_uz_kil, position = :rb)\nfig_kil","category":"section"},{"location":"mogi_mctigue/#Maximum-Displacement-vs.-Source-Depth","page":"Mogi & McTigue Models","title":"Maximum Displacement vs. Source Depth","text":"The maximum vertical displacement U_zmax (at x=0) decreases rapidly with increasing source depth for both models.\n\nfig3 = Figure(size = (700, 500))\nax3 = Axis(fig3[1, 1], xlabel = \"Source depth d (km)\", ylabel = \"Uz_max (mm)\",\n    title = \"Maximum Vertical Displacement vs. Depth\")\n\nd_range = range(1000, 13000, length = 50)\nradii = [500.0, 1000.0, 2000.0]\ncolors_m = [:blue, :red, :green]\ncolors_mc = [:cyan, :orange, :lightgreen]\nlabels_a = [\"a = 0.5 km\", \"a = 1.0 km\", \"a = 2.0 km\"]\n\nfor (i, a_val) in enumerate(radii)\n    Uz_max_mogi = Float64[]\n    Uz_max_mctigue = Float64[]\n\n    for d_val in d_range\n        x_near = 1.0  # near x=0\n\n        prob_m = NonlinearProblem(mogi_compiled,\n            Dict([\n                mogi_compiled.G => G_val, mogi_compiled.ν => ν_val,\n                mogi_compiled.ΔP => ΔP_val, mogi_compiled.a => a_val,\n                mogi_compiled.d => d_val, mogi_compiled.x => x_near]))\n        sol_m = solve(prob_m)\n        push!(Uz_max_mogi, sol_m[mogi_compiled.Uz] * 1000)\n\n        prob_mc = NonlinearProblem(mctigue_compiled,\n            Dict([\n                mctigue_compiled.G => G_val, mctigue_compiled.ν => ν_val,\n                mctigue_compiled.ΔP => ΔP_val, mctigue_compiled.a => a_val,\n                mctigue_compiled.d => d_val, mctigue_compiled.x => x_near]))\n        sol_mc = solve(prob_mc)\n        push!(Uz_max_mctigue, sol_mc[mctigue_compiled.Uz] * 1000)\n    end\n\n    d_km = collect(d_range) ./ 1000\n    lines!(ax3, d_km, Uz_max_mogi, color = colors_m[i],\n        label = \"Mogi \" * labels_a[i])\n    lines!(ax3, d_km, Uz_max_mctigue, color = colors_mc[i], linestyle = :dash,\n        label = \"McTigue \" * labels_a[i])\nend\n\naxislegend(ax3, position = :rt)\nfig3","category":"section"},{"location":"mogi_mctigue/#Geodynamics.MogiModel","page":"Mogi & McTigue Models","title":"Geodynamics.MogiModel","text":"MogiModel(; name) -> ModelingToolkit.System\n\n\nMogi (1958) point-source model for volcanic surface deformation.\n\nComputes horizontal-radial (Ur) and vertical (Uz) surface displacements due to a pressurized spherical cavity in an elastic half-space, using the small-sphere (point-source) approximation (ε = a/d ≪ 1).\n\nReference: Mogi, K., 1958. Relations between the eruptions of various volcanoes and the deformations of the ground surfaces around them. Bull. Earthq. Res. Inst. 36, 99–134. As presented in Taylor et al. (2021), Eqs. 1–2.\n\nParameters:\n\nG: Shear modulus (Pa)\nν: Poisson's ratio (dimensionless)\nΔP: Source overpressure (Pa)\na: Source radius (m)\nd: Source depth (m)\nx: Horizontal distance from source (m)\n\n\n\n\n\n","category":"function"},{"location":"mogi_mctigue/#Geodynamics.McTigueModel","page":"Mogi & McTigue Models","title":"Geodynamics.McTigueModel","text":"McTigueModel(; name) -> ModelingToolkit.System\n\n\nMcTigue (1987) finite-sphere model for volcanic surface deformation.\n\nExtends the Mogi model by incorporating higher-order correction terms that account for the finite radius of a spherical deformation source. The correction terms depend on ε = a/d and provide improved accuracy for larger ε values.\n\nThe McTigue model agrees with FE models within 5% for ε < 0.59, compared to ε < 0.37 for the Mogi model (Taylor et al., 2021).\n\nReference: McTigue, D.F., 1987. Elastic stress and deformation near a finite spherical magma body: resolution of the point source paradox. J. Geophys. Res. 92 (B12), 12931. As presented in Taylor et al. (2021), Eqs. 3–4.\n\nParameters:\n\nG: Shear modulus (Pa)\nν: Poisson's ratio (dimensionless)\nΔP: Source overpressure (Pa)\na: Source radius (m)\nd: Source depth (m)\nx: Horizontal distance from source (m)\n\n\n\n\n\n","category":"function"}]
}
