<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Mogi &amp; McTigue Models · Geodynamics.jl</title><meta name="title" content="Mogi &amp; McTigue Models · Geodynamics.jl"/><meta property="og:title" content="Mogi &amp; McTigue Models · Geodynamics.jl"/><meta property="twitter:title" content="Mogi &amp; McTigue Models · Geodynamics.jl"/><meta name="description" content="Documentation for Geodynamics.jl."/><meta property="og:description" content="Documentation for Geodynamics.jl."/><meta property="twitter:description" content="Documentation for Geodynamics.jl."/><meta property="og:url" content="https://geodynamics.earthsci.dev/mogi_mctigue/"/><meta property="twitter:url" content="https://geodynamics.earthsci.dev/mogi_mctigue/"/><link rel="canonical" href="https://geodynamics.earthsci.dev/mogi_mctigue/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Geodynamics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Mogi &amp; McTigue Models</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Implementation"><span>Implementation</span></a></li><li><a class="tocitem" href="#Analysis"><span>Analysis</span></a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Mogi &amp; McTigue Models</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Mogi &amp; McTigue Models</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/EarthSciML/Geodynamics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/EarthSciML/Geodynamics.jl/blob/main/docs/src/mogi_mctigue.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Mogi-and-McTigue-Volcanic-Deformation-Models"><a class="docs-heading-anchor" href="#Mogi-and-McTigue-Volcanic-Deformation-Models">Mogi &amp; McTigue Volcanic Deformation Models</a><a id="Mogi-and-McTigue-Volcanic-Deformation-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Mogi-and-McTigue-Volcanic-Deformation-Models" title="Permalink"></a></h1><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>The Mogi (1958) and McTigue (1987) models are analytical solutions for computing surface displacements caused by a pressurized spherical magma chamber embedded in an elastic, homogeneous half-space with a flat free surface. These models are widely used in volcano geodesy to interpret ground deformation observations and to infer magma reservoir properties (location, size, and overpressure).</p><p>The <strong>Mogi model</strong> approximates the magma chamber as a point source (small sphere approximation, <span>$\varepsilon = a/d \ll 1$</span>), where <span>$a$</span> is the source radius and <span>$d$</span> is the source depth. The <strong>McTigue model</strong> extends Mogi by incorporating higher-order correction terms that account for the finite dimensions of the spherical source, providing improved accuracy for larger <span>$\varepsilon$</span> values.</p><p>Taylor et al. (2021) demonstrated that:</p><ul><li>The Mogi model agrees with Finite Element models within 5% when <span>$\varepsilon &lt; 0.37$</span></li><li>The McTigue model agrees within 5% when <span>$\varepsilon &lt; 0.59$</span></li></ul><p><strong>Reference</strong>: Taylor, N.C., Johnson, J.H., Herd, R.A. (2021). &quot;Making the most of the Mogi model: Size matters.&quot; <em>Journal of Volcanology and Geothermal Research</em>, 419, 107380. <a href="https://doi.org/10.1016/j.jvolgeores.2021.107380">https://doi.org/10.1016/j.jvolgeores.2021.107380</a></p><article><details class="docstring" open="true"><summary id="Geodynamics.MogiModel"><a class="docstring-binding" href="#Geodynamics.MogiModel"><code>Geodynamics.MogiModel</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">MogiModel(; name) -&gt; ModelingToolkit.System
</code></pre><p>Mogi (1958) point-source model for volcanic surface deformation.</p><p>Computes horizontal-radial (<code>Ur</code>) and vertical (<code>Uz</code>) surface displacements due to a pressurized spherical cavity in an elastic half-space, using the small-sphere (point-source) approximation (ε = a/d ≪ 1).</p><p><strong>Reference</strong>: Mogi, K., 1958. Relations between the eruptions of various volcanoes and the deformations of the ground surfaces around them. Bull. Earthq. Res. Inst. 36, 99–134. As presented in Taylor et al. (2021), Eqs. 1–2.</p><p><strong>Parameters:</strong></p><ul><li><code>G</code>: Shear modulus (Pa)</li><li><code>ν</code>: Poisson&#39;s ratio (dimensionless)</li><li><code>ΔP</code>: Source overpressure (Pa)</li><li><code>a</code>: Source radius (m)</li><li><code>d</code>: Source depth (m)</li><li><code>x</code>: Horizontal distance from source (m)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Geodynamics.jl/blob/a88e78179bc2349a158c684dc3480dccdeaa5bb5/src/mogi_mctigue.jl#L25">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Geodynamics.McTigueModel"><a class="docstring-binding" href="#Geodynamics.McTigueModel"><code>Geodynamics.McTigueModel</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">McTigueModel(; name) -&gt; ModelingToolkit.System
</code></pre><p>McTigue (1987) finite-sphere model for volcanic surface deformation.</p><p>Extends the Mogi model by incorporating higher-order correction terms that account for the finite radius of a spherical deformation source. The correction terms depend on ε = a/d and provide improved accuracy for larger ε values.</p><p>The McTigue model agrees with FE models within 5% for ε &lt; 0.59, compared to ε &lt; 0.37 for the Mogi model (Taylor et al., 2021).</p><p><strong>Reference</strong>: McTigue, D.F., 1987. Elastic stress and deformation near a finite spherical magma body: resolution of the point source paradox. J. Geophys. Res. 92 (B12), 12931. As presented in Taylor et al. (2021), Eqs. 3–4.</p><p><strong>Parameters:</strong></p><ul><li><code>G</code>: Shear modulus (Pa)</li><li><code>ν</code>: Poisson&#39;s ratio (dimensionless)</li><li><code>ΔP</code>: Source overpressure (Pa)</li><li><code>a</code>: Source radius (m)</li><li><code>d</code>: Source depth (m)</li><li><code>x</code>: Horizontal distance from source (m)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/Geodynamics.jl/blob/a88e78179bc2349a158c684dc3480dccdeaa5bb5/src/mogi_mctigue.jl#L82">source</a></section></details></article><h2 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h2><p>The models compute horizontal-radial (<span>$U_r$</span>) and vertical (<span>$U_z$</span>) surface displacements as functions of horizontal distance <span>$x$</span> from the source.</p><h3 id="State-Variables"><a class="docs-heading-anchor" href="#State-Variables">State Variables</a><a id="State-Variables-1"></a><a class="docs-heading-anchor-permalink" href="#State-Variables" title="Permalink"></a></h3><pre><code class="language-julia hljs">using DataFrames, ModelingToolkit, Symbolics, DynamicQuantities
using Geodynamics

sys = MogiModel()
vars = unknowns(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [dimension(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>3×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">R</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Distance from source to surface point</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">Ur</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Horizontal-radial surface displacement</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">Uz</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Vertical surface displacement</td></tr></tbody></table></div><h3 id="Parameters"><a class="docs-heading-anchor" href="#Parameters">Parameters</a><a id="Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Parameters" title="Permalink"></a></h3><pre><code class="language-julia hljs">params = parameters(sys)
param_units = String[]
for p in params
    u = ModelingToolkit.get_unit(p)
    push!(param_units, u === nothing ? &quot;dimensionless&quot; : string(dimension(u)))
end
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in params],
    :Units =&gt; param_units,
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in params]
)</code></pre><div><div style = "float: left;"><span>7×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">a</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Source radius</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">G</td><td style = "text-align: left;">m⁻¹ kg s⁻²</td><td style = "text-align: left;">Shear modulus</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">d</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Source depth</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">ΔP</td><td style = "text-align: left;">m⁻¹ kg s⁻²</td><td style = "text-align: left;">Source overpressure</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">ν</td><td style = "text-align: left;"></td><td style = "text-align: left;">Poisson&apos;s ratio (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">x</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Horizontal distance from source</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">one_m</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Unit length for non-dimensionalization</td></tr></tbody></table></div><h3 id="Equations"><a class="docs-heading-anchor" href="#Equations">Equations</a><a id="Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Equations" title="Permalink"></a></h3><p><strong>Mogi Model</strong> (Equations 1-2 from Taylor et al., 2021):</p><pre><code class="language-julia hljs">equations(sys)</code></pre><p class="math-container">\[ \begin{align}
R\left( t \right) &amp;= \left( \frac{d^{2}}{\mathtt{one\_m}^{2}} + \frac{x^{2}}{\mathtt{one\_m}^{2}} \right)^{0.5} \mathtt{one\_m} \\
\mathtt{Ur}\left( t \right) &amp;= \frac{a^{3} x \mathtt{{\Delta}P} \left( 1 - \nu \right)}{\left( R\left( t \right) \right)^{3} G} \\
\mathtt{Uz}\left( t \right) &amp;= \frac{a^{3} d \mathtt{{\Delta}P} \left( 1 - \nu \right)}{\left( R\left( t \right) \right)^{3} G}
\end{align}
 \]</p><p><strong>McTigue Model</strong> (Equations 3-4 from Taylor et al., 2021):</p><pre><code class="language-julia hljs">mctigue_sys = McTigueModel()
equations(mctigue_sys)</code></pre><p class="math-container">\[ \begin{align}
R\left( t \right) &amp;= \left( \frac{d^{2}}{\mathtt{one\_m}^{2}} + \frac{x^{2}}{\mathtt{one\_m}^{2}} \right)^{0.5} \mathtt{one\_m} \\
\mathtt{Ur}\left( t \right) &amp;= \frac{a^{3} x \left( 1 + \left( \frac{a}{d} \right)^{3} \left( \frac{15 d^{2} \left( -2 + \nu \right)}{4 \left( R\left( t \right) \right)^{2} \left( -7 + 5 \nu \right)} + \frac{1 + \nu}{2 \left( -7 + 5 \nu \right)} \right) \right) \mathtt{{\Delta}P} \left( 1 - \nu \right)}{\left( R\left( t \right) \right)^{3} G} \\
\mathtt{Uz}\left( t \right) &amp;= \frac{a^{3} d \left( 1 + \left( \frac{a}{d} \right)^{3} \left( \frac{15 d^{2} \left( -2 + \nu \right)}{4 \left( R\left( t \right) \right)^{2} \left( -7 + 5 \nu \right)} + \frac{1 + \nu}{2 \left( -7 + 5 \nu \right)} \right) \right) \mathtt{{\Delta}P} \left( 1 - \nu \right)}{\left( R\left( t \right) \right)^{3} G}
\end{align}
 \]</p><h3 id="Reference-Parameters-(Table-1,-Taylor-et-al.,-2021)"><a class="docs-heading-anchor" href="#Reference-Parameters-(Table-1,-Taylor-et-al.,-2021)">Reference Parameters (Table 1, Taylor et al., 2021)</a><a id="Reference-Parameters-(Table-1,-Taylor-et-al.,-2021)-1"></a><a class="docs-heading-anchor-permalink" href="#Reference-Parameters-(Table-1,-Taylor-et-al.,-2021)" title="Permalink"></a></h3><p>The following parameters, based on Kilauea Volcano, Hawaii, are used in the analysis below:</p><table><tr><th style="text-align: left">Symbol</th><th style="text-align: left">Definition</th><th style="text-align: left">Units</th><th style="text-align: left">Value</th></tr><tr><td style="text-align: left"><span>$G$</span></td><td style="text-align: left">Shear modulus</td><td style="text-align: left">GPa</td><td style="text-align: left">4.0</td></tr><tr><td style="text-align: left"><span>$\nu$</span></td><td style="text-align: left">Poisson&#39;s ratio</td><td style="text-align: left">–</td><td style="text-align: left">0.25</td></tr><tr><td style="text-align: left"><span>$\Delta P$</span></td><td style="text-align: left">Overpressure</td><td style="text-align: left">MPa</td><td style="text-align: left">2.0</td></tr><tr><td style="text-align: left"><span>$a$</span></td><td style="text-align: left">Source radius</td><td style="text-align: left">km</td><td style="text-align: left">variable</td></tr><tr><td style="text-align: left"><span>$d$</span></td><td style="text-align: left">Source depth</td><td style="text-align: left">km</td><td style="text-align: left">variable</td></tr><tr><td style="text-align: left"><span>$\varepsilon$</span></td><td style="text-align: left"><span>$a/d$</span></td><td style="text-align: left">–</td><td style="text-align: left">0.05 – 0.70</td></tr><tr><td style="text-align: left"><span>$U_r$</span></td><td style="text-align: left">Horizontal-radial displacement</td><td style="text-align: left">m</td><td style="text-align: left">result</td></tr><tr><td style="text-align: left"><span>$U_z$</span></td><td style="text-align: left">Vertical displacement</td><td style="text-align: left">m</td><td style="text-align: left">result</td></tr></table><h3 id="Reference-Parameters-for-Kīlauea-Events-(Table-3,-Taylor-et-al.,-2021)"><a class="docs-heading-anchor" href="#Reference-Parameters-for-Kīlauea-Events-(Table-3,-Taylor-et-al.,-2021)">Reference Parameters for Kīlauea Events (Table 3, Taylor et al., 2021)</a><a id="Reference-Parameters-for-Kīlauea-Events-(Table-3,-Taylor-et-al.,-2021)-1"></a><a class="docs-heading-anchor-permalink" href="#Reference-Parameters-for-Kīlauea-Events-(Table-3,-Taylor-et-al.,-2021)" title="Permalink"></a></h3><p>Model parameters for two intrusion events at Kīlauea Volcano, Hawai&#39;i:</p><table><tr><th style="text-align: left">Symbol</th><th style="text-align: left">Definition</th><th style="text-align: left">Units</th><th style="text-align: left">Value(s)</th></tr><tr><td style="text-align: left"><span>$G$</span></td><td style="text-align: left">Shear modulus</td><td style="text-align: left">GPa</td><td style="text-align: left">4.0</td></tr><tr><td style="text-align: left"><span>$\nu$</span></td><td style="text-align: left">Poisson&#39;s ratio</td><td style="text-align: left">–</td><td style="text-align: left">0.25</td></tr><tr><td style="text-align: left"><span>$\Delta P$</span></td><td style="text-align: left">Overpressure</td><td style="text-align: left">MPa</td><td style="text-align: left">−3.73, −3.55</td></tr><tr><td style="text-align: left"><span>$a$</span></td><td style="text-align: left">Radius</td><td style="text-align: left">km</td><td style="text-align: left">0.40 – 1.10</td></tr><tr><td style="text-align: left"><span>$d$</span></td><td style="text-align: left">Depth</td><td style="text-align: left">km</td><td style="text-align: left">1.00 – 3.00</td></tr></table><p>Source overpressures are inferred from tilt measurements; −3.73 and −3.55 MPa are overpressures for events in June 2007 and March 2011 respectively.</p><h2 id="Analysis"><a class="docs-heading-anchor" href="#Analysis">Analysis</a><a id="Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Analysis" title="Permalink"></a></h2><h3 id="Displacement-Profiles-(cf.-Figure-1-geometry)"><a class="docs-heading-anchor" href="#Displacement-Profiles-(cf.-Figure-1-geometry)">Displacement Profiles (cf. Figure 1 geometry)</a><a id="Displacement-Profiles-(cf.-Figure-1-geometry)-1"></a><a class="docs-heading-anchor-permalink" href="#Displacement-Profiles-(cf.-Figure-1-geometry)" title="Permalink"></a></h3><p>Surface displacement profiles for both models, using the reference parameters from Table 1 of Taylor et al. (2021): <span>$G = 4.0$</span> GPa, <span>$\nu = 0.25$</span>, <span>$\Delta P = 2.0$</span> MPa.</p><pre><code class="language-julia hljs">using CairoMakie
using ModelingToolkit: mtkcompile
using NonlinearSolve

# Compile both models
mogi_compiled = mtkcompile(MogiModel())
mctigue_compiled = mtkcompile(McTigueModel())

# Parameters from Table 1
G_val = 4.0e9    # Pa
ν_val = 0.25
ΔP_val = 2.0e6   # Pa
d_val = 4000.0    # m (4 km depth)

# Evaluate displacement profiles for different source radii
x_range = range(200, 25000, length = 200)

fig = Figure(size = (900, 600))
ax_ur = Axis(fig[1, 1], xlabel = &quot;Distance x (km)&quot;, ylabel = &quot;Ur (mm)&quot;,
    title = &quot;Horizontal-Radial Displacement&quot;)
ax_uz = Axis(fig[2, 1], xlabel = &quot;Distance x (km)&quot;, ylabel = &quot;Uz (mm)&quot;,
    title = &quot;Vertical Displacement&quot;)

colors_mogi = [:blue, :red, :green]
colors_mctigue = [:cyan, :orange, :lightgreen]
radii = [500.0, 1000.0, 2000.0]
labels_a = [&quot;a = 0.5 km&quot;, &quot;a = 1.0 km&quot;, &quot;a = 2.0 km&quot;]

for (i, a_val) in enumerate(radii)
    Ur_mogi = Float64[]
    Uz_mogi = Float64[]
    Ur_mctigue = Float64[]
    Uz_mctigue = Float64[]

    for x_val in x_range
        # Mogi
        prob_m = NonlinearProblem(mogi_compiled,
            Dict([
                mogi_compiled.G =&gt; G_val, mogi_compiled.ν =&gt; ν_val,
                mogi_compiled.ΔP =&gt; ΔP_val, mogi_compiled.a =&gt; a_val,
                mogi_compiled.d =&gt; d_val, mogi_compiled.x =&gt; x_val]))
        sol_m = solve(prob_m)
        push!(Ur_mogi, sol_m[mogi_compiled.Ur] * 1000)  # convert to mm
        push!(Uz_mogi, sol_m[mogi_compiled.Uz] * 1000)

        # McTigue
        prob_mc = NonlinearProblem(mctigue_compiled,
            Dict([
                mctigue_compiled.G =&gt; G_val, mctigue_compiled.ν =&gt; ν_val,
                mctigue_compiled.ΔP =&gt; ΔP_val, mctigue_compiled.a =&gt; a_val,
                mctigue_compiled.d =&gt; d_val, mctigue_compiled.x =&gt; x_val]))
        sol_mc = solve(prob_mc)
        push!(Ur_mctigue, sol_mc[mctigue_compiled.Ur] * 1000)
        push!(Uz_mctigue, sol_mc[mctigue_compiled.Uz] * 1000)
    end

    x_km = collect(x_range) ./ 1000
    lines!(ax_ur, x_km, Ur_mogi, color = colors_mogi[i], label = &quot;Mogi &quot; * labels_a[i])
    lines!(ax_ur, x_km, Ur_mctigue, color = colors_mctigue[i], linestyle = :dash,
        label = &quot;McTigue &quot; * labels_a[i])
    lines!(ax_uz, x_km, Uz_mogi, color = colors_mogi[i], label = &quot;Mogi &quot; * labels_a[i])
    lines!(ax_uz, x_km, Uz_mctigue, color = colors_mctigue[i], linestyle = :dash,
        label = &quot;McTigue &quot; * labels_a[i])
end

axislegend(ax_ur, position = :rt)
axislegend(ax_uz, position = :rt)
fig</code></pre><img src="1fc0d7e7.png" alt="Example block output"/><h3 id="McTigue-Correction-Magnitude-vs.-epsilon-(cf.-Figure-2)"><a class="docs-heading-anchor" href="#McTigue-Correction-Magnitude-vs.-epsilon-(cf.-Figure-2)">McTigue Correction Magnitude vs. epsilon (cf. Figure 2)</a><a id="McTigue-Correction-Magnitude-vs.-epsilon-(cf.-Figure-2)-1"></a><a class="docs-heading-anchor-permalink" href="#McTigue-Correction-Magnitude-vs.-epsilon-(cf.-Figure-2)" title="Permalink"></a></h3><p>The percentage difference between Mogi and McTigue predictions increases with <span>$\varepsilon = a/d$</span>, illustrating the growing importance of finite-body corrections.</p><pre><code class="language-julia hljs">fig2 = Figure(size = (700, 500))
ax = Axis(fig2[1, 1],
    xlabel = &quot;epsilon = a/d&quot;,
    ylabel = &quot;(McTigue - Mogi) / Mogi x 100 (%)&quot;,
    title = &quot;McTigue vs Mogi: Relative Difference at Ur_max and Uz_max&quot;)

depths = [1000.0, 4000.0, 7000.0, 10000.0, 13000.0]
depth_colors = [:purple, :blue, :green, :orange, :gold]
depth_labels = [&quot;d = 1 km&quot;, &quot;d = 4 km&quot;, &quot;d = 7 km&quot;, &quot;d = 10 km&quot;, &quot;d = 13 km&quot;]

eps_range = range(0.05, 0.70, length = 50)

for (j, d_val) in enumerate(depths)
    pct_diff_ur = Float64[]
    pct_diff_uz = Float64[]

    for eps_val in eps_range
        a_val = eps_val * d_val

        # Evaluate at x = x_crit for Mogi (where Ur is maximum): x_crit = d/sqrt(2)
        x_crit = d_val / sqrt(2)

        # Mogi at x_crit
        prob_m = NonlinearProblem(mogi_compiled,
            Dict([
                mogi_compiled.G =&gt; G_val, mogi_compiled.ν =&gt; ν_val,
                mogi_compiled.ΔP =&gt; ΔP_val, mogi_compiled.a =&gt; a_val,
                mogi_compiled.d =&gt; d_val, mogi_compiled.x =&gt; x_crit]))
        sol_m = solve(prob_m)

        # McTigue at x_crit
        prob_mc = NonlinearProblem(mctigue_compiled,
            Dict([
                mctigue_compiled.G =&gt; G_val, mctigue_compiled.ν =&gt; ν_val,
                mctigue_compiled.ΔP =&gt; ΔP_val, mctigue_compiled.a =&gt; a_val,
                mctigue_compiled.d =&gt; d_val, mctigue_compiled.x =&gt; x_crit]))
        sol_mc = solve(prob_mc)

        push!(pct_diff_ur,
            (sol_mc[mctigue_compiled.Ur] - sol_m[mogi_compiled.Ur]) /
            sol_m[mogi_compiled.Ur] * 100)
        push!(pct_diff_uz,
            (sol_mc[mctigue_compiled.Uz] - sol_m[mogi_compiled.Uz]) /
            sol_m[mogi_compiled.Uz] * 100)
    end

    lines!(ax, collect(eps_range), pct_diff_ur, color = depth_colors[j],
        label = depth_labels[j] * &quot; (Ur)&quot;)
    lines!(ax, collect(eps_range), pct_diff_uz, color = depth_colors[j],
        linestyle = :dash, label = depth_labels[j] * &quot; (Uz)&quot;)
end

axislegend(ax, position = :lt)
fig2</code></pre><img src="def6f2bb.png" alt="Example block output"/><h3 id="Kīlauea-Deflation-Event-(cf.-Table-3-and-Section-4.5)"><a class="docs-heading-anchor" href="#Kīlauea-Deflation-Event-(cf.-Table-3-and-Section-4.5)">Kīlauea Deflation Event (cf. Table 3 and Section 4.5)</a><a id="Kīlauea-Deflation-Event-(cf.-Table-3-and-Section-4.5)-1"></a><a class="docs-heading-anchor-permalink" href="#Kīlauea-Deflation-Event-(cf.-Table-3-and-Section-4.5)" title="Permalink"></a></h3><p>Surface displacement profiles predicted by the Mogi and McTigue models for the June 2007 Kīlauea deflation event (<span>$\Delta P = -3.73$</span> MPa), using the best-fitting source parameters from Taylor et al. (2021). The negative overpressure corresponds to deflation (subsidence and inward radial displacement).</p><pre><code class="language-julia hljs">fig_kil = Figure(size = (900, 600))
ax_ur_kil = Axis(fig_kil[1, 1], xlabel = &quot;Distance x (km)&quot;, ylabel = &quot;Ur (mm)&quot;,
    title = &quot;Kīlauea June 2007: Horizontal-Radial Displacement&quot;)
ax_uz_kil = Axis(fig_kil[2, 1], xlabel = &quot;Distance x (km)&quot;, ylabel = &quot;Uz (mm)&quot;,
    title = &quot;Kīlauea June 2007: Vertical Displacement&quot;)

# Table 3 parameters for June 2007 event
G_kil = 4.0e9       # Pa
ν_kil = 0.25
ΔP_kil = -3.73e6    # Pa (deflation)

# Representative source geometries within the Table 3 range
cases = [
    (a = 500.0, d = 2000.0, label = &quot;a=0.5km, d=2km (ε=0.25)&quot;),
    (a = 800.0, d = 2000.0, label = &quot;a=0.8km, d=2km (ε=0.40)&quot;),
    (a = 800.0, d = 3000.0, label = &quot;a=0.8km, d=3km (ε=0.27)&quot;)
]
case_colors_m = [:blue, :red, :green]
case_colors_mc = [:cyan, :orange, :lightgreen]

x_range_kil = range(100, 15000, length = 150)

for (i, c) in enumerate(cases)
    Ur_m = Float64[]
    Uz_m = Float64[]
    Ur_mc = Float64[]
    Uz_mc = Float64[]

    for x_val in x_range_kil
        prob_m = NonlinearProblem(mogi_compiled,
            Dict([mogi_compiled.G =&gt; G_kil, mogi_compiled.ν =&gt; ν_kil,
                mogi_compiled.ΔP =&gt; ΔP_kil, mogi_compiled.a =&gt; c.a,
                mogi_compiled.d =&gt; c.d, mogi_compiled.x =&gt; x_val]))
        sol_m = solve(prob_m)
        push!(Ur_m, sol_m[mogi_compiled.Ur] * 1000)
        push!(Uz_m, sol_m[mogi_compiled.Uz] * 1000)

        prob_mc = NonlinearProblem(mctigue_compiled,
            Dict([mctigue_compiled.G =&gt; G_kil, mctigue_compiled.ν =&gt; ν_kil,
                mctigue_compiled.ΔP =&gt; ΔP_kil, mctigue_compiled.a =&gt; c.a,
                mctigue_compiled.d =&gt; c.d, mctigue_compiled.x =&gt; x_val]))
        sol_mc = solve(prob_mc)
        push!(Ur_mc, sol_mc[mctigue_compiled.Ur] * 1000)
        push!(Uz_mc, sol_mc[mctigue_compiled.Uz] * 1000)
    end

    x_km = collect(x_range_kil) ./ 1000
    lines!(ax_ur_kil, x_km, Ur_m, color = case_colors_m[i], label = &quot;Mogi &quot; * c.label)
    lines!(ax_ur_kil, x_km, Ur_mc, color = case_colors_mc[i], linestyle = :dash,
        label = &quot;McTigue &quot; * c.label)
    lines!(ax_uz_kil, x_km, Uz_m, color = case_colors_m[i], label = &quot;Mogi &quot; * c.label)
    lines!(ax_uz_kil, x_km, Uz_mc, color = case_colors_mc[i], linestyle = :dash,
        label = &quot;McTigue &quot; * c.label)
end

axislegend(ax_ur_kil, position = :rb)
axislegend(ax_uz_kil, position = :rb)
fig_kil</code></pre><img src="453dab0b.png" alt="Example block output"/><h3 id="Maximum-Displacement-vs.-Source-Depth"><a class="docs-heading-anchor" href="#Maximum-Displacement-vs.-Source-Depth">Maximum Displacement vs. Source Depth</a><a id="Maximum-Displacement-vs.-Source-Depth-1"></a><a class="docs-heading-anchor-permalink" href="#Maximum-Displacement-vs.-Source-Depth" title="Permalink"></a></h3><p>The maximum vertical displacement <span>$U_{z,max}$</span> (at <span>$x=0$</span>) decreases rapidly with increasing source depth for both models.</p><pre><code class="language-julia hljs">fig3 = Figure(size = (700, 500))
ax3 = Axis(fig3[1, 1], xlabel = &quot;Source depth d (km)&quot;, ylabel = &quot;Uz_max (mm)&quot;,
    title = &quot;Maximum Vertical Displacement vs. Depth&quot;)

d_range = range(1000, 13000, length = 50)
radii = [500.0, 1000.0, 2000.0]
colors_m = [:blue, :red, :green]
colors_mc = [:cyan, :orange, :lightgreen]
labels_a = [&quot;a = 0.5 km&quot;, &quot;a = 1.0 km&quot;, &quot;a = 2.0 km&quot;]

for (i, a_val) in enumerate(radii)
    Uz_max_mogi = Float64[]
    Uz_max_mctigue = Float64[]

    for d_val in d_range
        x_near = 1.0  # near x=0

        prob_m = NonlinearProblem(mogi_compiled,
            Dict([
                mogi_compiled.G =&gt; G_val, mogi_compiled.ν =&gt; ν_val,
                mogi_compiled.ΔP =&gt; ΔP_val, mogi_compiled.a =&gt; a_val,
                mogi_compiled.d =&gt; d_val, mogi_compiled.x =&gt; x_near]))
        sol_m = solve(prob_m)
        push!(Uz_max_mogi, sol_m[mogi_compiled.Uz] * 1000)

        prob_mc = NonlinearProblem(mctigue_compiled,
            Dict([
                mctigue_compiled.G =&gt; G_val, mctigue_compiled.ν =&gt; ν_val,
                mctigue_compiled.ΔP =&gt; ΔP_val, mctigue_compiled.a =&gt; a_val,
                mctigue_compiled.d =&gt; d_val, mctigue_compiled.x =&gt; x_near]))
        sol_mc = solve(prob_mc)
        push!(Uz_max_mctigue, sol_mc[mctigue_compiled.Uz] * 1000)
    end

    d_km = collect(d_range) ./ 1000
    lines!(ax3, d_km, Uz_max_mogi, color = colors_m[i],
        label = &quot;Mogi &quot; * labels_a[i])
    lines!(ax3, d_km, Uz_max_mctigue, color = colors_mc[i], linestyle = :dash,
        label = &quot;McTigue &quot; * labels_a[i])
end

axislegend(ax3, position = :rt)
fig3</code></pre><img src="eea1a3c4.png" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../api/">API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Thursday 12 February 2026 18:58">Thursday 12 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
